{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "POST /api/query event schema",
  "definitions": {
    "request": {
      "type": "object",
      "required": ["query"],
      "properties": {
        "query": {"type": "string"},
        "pseudo_user_id": {"type": "string"},
        "page_context": {"type": "object","properties":{"sectionId":{"type":"string"}}}
      },
      "additionalProperties": false
    },
    "citation": {
      "type": "object",
      "properties": {
        "url": {"type": "string", "format": "uri"},
        "anchor": {"type": "string"},
        "snippet": {"type": "string"}
      },
      "required": ["url"],
      "additionalProperties": false
    },
    "response": {
      "type": "object",
      "required": ["answer","citations","confidence","fallback"],
      "properties": {
        "answer": {"type": "string"},
        "citations": {"type": "array", "items": {"$ref": "#/definitions/citation"}},
        "confidence": {"type": "number", "minimum": 0, "maximum": 1},
        "fallback": {"type": "boolean"},
        "anchors": {"type":"array","items":{"type":"string"}}
      },
      "additionalProperties": false
    }
  },
  "type": "object",
  "properties": {
    "request": { "$ref": "#/definitions/request" },
    "response": { "$ref": "#/definitions/response" }
  }
}
